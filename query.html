<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BCTP - è¡Œç‚ºå¾ŒæœæŸ¥è©¢</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ›¡ï¸</text></svg>">
</head>
<body>
    <header>
        <div class="container">
            <h1>BCTP</h1>
            <p>éœ¸å‡Œè¡Œç‚ºå¾Œæœé€æ˜åŒ–è³‡è¨Šå¹³å°</p>
        </div>
    </header>

    <main>
        <div class="container main-layout">
            
            <div class="filter-panel">
                <h2>æ­¥é©Ÿä¸€ï¼šè¡Œç‚ºå‹¾é¸</h2>
                <p>å‹¾é¸è§¸ç™¼æ³•å¾‹å¾Œæœçš„è¡Œç‚ºï¼ŒæŸ¥çœ‹å°æ‡‰çš„æ³•å¾‹å¾Œæœã€‚</p>

                <div class="checkbox-group" id="behavior-filters">
                    <label><input type="checkbox" name="behavior" value="physical-injury"> è‚¢é«”æ¨æ‰“ / é€ æˆè¼•å‚·</label>
                    <label><input type="checkbox" name="behavior" value="online-slander"> ç¶²è·¯æ•£å¸ƒè¬ è¨€ / æå®³åè­½</label>
                    <label><input type="checkbox" name="behavior" value="money-extortion"> å¨è„…å–è²¡ / ææ¯€æ”¯ä»˜é‡‘éŒ¢</label>
                    <label><input type="checkbox" name="behavior" value="psychological-damage"> å¯†é›†è¨Šæ¯é¨·æ“¾ / é€ æˆç²¾ç¥å£“åŠ›</label>
                </div>
            </div>

            <div class="results-panel">
                <h2>æ­¥é©ŸäºŒï¼šå¾Œæœè­¦ç¤º (å³æ™‚äº’å‹•)</h2>
                <p>è«‹åœ¨å·¦å´å‹¾é¸è¡Œç‚ºæ¨™ç±¤ï¼Œçµæœå°‡å³æ™‚é¡¯ç¤ºç›¸é—œæ³•å¾‹æ¢æ–‡èˆ‡åˆ¤ä¾‹ã€‚</p>

                <div id="results-area">
                    <div id="statute-results"></div>
                    <div id="case-results"></div>
                </div>
            </div>
            
        </div> 

        <div class="button-footer">
            <a href="form.html" class="submit-button">ä¸‹ä¸€æ­¥ï¼šåæ€è¡¨å–® &rarr;</a>
        </div>
    </main>
    
    <footer>
        <p>BCTP (Bullying Consequence Transparency Platform)</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const filterContainer = document.getElementById('behavior-filters');
            const statuteResults = document.getElementById('statute-results'); 
            const caseResults = document.getElementById('case-results');       
            const checkboxes = filterContainer.querySelectorAll('input[type="checkbox"]');

            let lawKeywords = {}; 

            // ç•°æ­¥è®€å– data.json æª”æ¡ˆ
            async function loadData() {
                statuteResults.innerHTML = '<div class="alert-info">æ­£åœ¨åŠ è¼‰æ³•å¾‹æ•¸æ“š...</div>';
                try {
                    const response = await fetch('data.json');
                    if (!response.ok) throw new Error(`HTTP éŒ¯èª¤! ç‹€æ…‹: ${response.status}`);
                    lawKeywords = await response.json();
                    initializePage();
                } catch (error) {
                    console.error('ç„¡æ³•è®€å– data.json æª”æ¡ˆ:', error);
                    statuteResults.innerHTML = `<div class="alert-error">éŒ¯èª¤ï¼šç„¡æ³•åŠ è¼‰æ³•å¾‹æ•¸æ“šæª”æ¡ˆ (data.json)ã€‚</div>`;
                }
            }
            
            function initializePage() {
                function updateResults() {
                    const checkedValues = Array.from(checkboxes)
                        .filter(cb => cb.checked)
                        .map(cb => cb.value);

                    statuteResults.innerHTML = ''; 
                    caseResults.innerHTML = '';    

                    if (checkedValues.length === 0) {
                        statuteResults.innerHTML = `<div class="alert-info">è«‹åœ¨å·¦å´å‹¾é¸ä¸€é …æˆ–å¤šé …è¡Œç‚ºï¼Œçµæœå°‡æœƒå³æ™‚å‘ˆç¾ã€‚</div>`;
                        localStorage.removeItem('selectedBehaviors'); // æ¸…é™¤æ•¸æ“š
                        return;
                    }

                    statuteResults.innerHTML = '<h3>ç›¸é—œæ³•å¾‹æ¢æ–‡</h3>';
                    caseResults.innerHTML = '<h3>çœŸå¯¦åˆ¤ä¾‹è­¦ç¤º</h3>';
                    
                    let behaviorNames = [];

                    checkedValues.forEach(value => {
                        const data = lawKeywords[value];
                        if (data) {
                            // æ”¶é›†è¡Œç‚ºåç¨±ä¸¦æº–å‚™å­˜å…¥ Local Storage
                            const labelElement = filterContainer.querySelector(`input[value="${value}"]`).parentElement;
                            behaviorNames.push(labelElement ? labelElement.textContent.trim() : value);

                            // 1. æ¢æ–‡å¡ç‰‡
                            statuteResults.innerHTML += `
                                <div class="result-card statute-card">
                                    <h3>${data.lawName}</h3>
                                    <p><strong>ç¬¬ ${data.articleNo} æ¢ï¼š</strong> ${data.statuteContent}</p>
                                    <p><a href="${data.statuteLink}" target="_blank">å‰å¾€å…¨åœ‹æ³•è¦è³‡æ–™åº« &rarr;</a></p>
                                </div>
                            `;
                            
                            // 2. åˆ¤ä¾‹å¡ç‰‡
                            caseResults.innerHTML += `
                                <div class="result-card case-card">
                                    <h3>${data.caseTitle}</h3>
                                    <p>${data.caseContent}</p>
                                    <p><a href="${data.caseLink}" target="_blank">å¸æ³•é™¢æ³•å­¸è³‡æ–™æª¢ç´¢ç³»çµ± &rarr;</a></p>
                                </div>
                            `;
                        }
                    });
                    
                    // --- å°‡å‹¾é¸çš„è¡Œç‚ºåç¨±å„²å­˜åˆ° Local Storage ---
                    const selectedBehaviors = behaviorNames.join('; '); 
                    localStorage.setItem('selectedBehaviors', selectedBehaviors);
                }

                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', updateResults);
                });
                updateResults();
            }

            loadData();
        });
    </script>
</body>
</html>
