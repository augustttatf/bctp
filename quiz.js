// ===============================
//     quiz.jsï¼ˆå®Œæ•´å¯é‹ä½œï¼‰
// ===============================

// ğŸ‘‰ è®€å– query.html å‹¾é¸çš„è¡Œç‚ºï¼ˆåŒ…å« typeï¼‰
const selected = JSON.parse(localStorage.getItem("selected_behaviors") || "[]");

// è‹¥ç„¡é¸é … â†’ ä¸å…è¨±é€²å…¥
if (!selected || selected.length === 0) {
    alert("è«‹å…ˆåœ¨æŸ¥è©¢é é¢å‹¾é¸è¡Œç‚ºï¼");
    window.location.href = "query.html";
}

// å–å¾— questionType æ¸…å–®
const selectedTypes = selected.map(b => parseInt(b.type));

// ===============================
//      é¡Œåº«ï¼ˆä½ æœƒæ”¾ 40 é¡Œï¼‰
// ===============================

  const ALL_QUESTIONS = [
  // --- å¯†é›†è¨Šæ¯é¨·æ“¾ï¼ˆ10 é¡Œï¼‰ ---
  {
    question: "å°‘å¹´æ³•é™¢ä¾ã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 26 æ¢è²¬ä»˜æ™‚ï¼Œå°æ–¼å¯†é›†è¨Šæ¯é¨·æ“¾çš„å°‘å¹´ï¼Œå¯ä»¥ä¸‹é”ä½•ç¨®ç¦æ­¢è¡Œç‚ºçš„å‘½ä»¤ï¼Ÿ",
    options: ["ç¦æ­¢å°‘å¹´åœ¨æ ¡åœ’å…§ä½¿ç”¨æ‰‹æ©Ÿ", "ç¦æ­¢å°è¢«å®³äººæˆ–å…¶å®¶å±¬ç‚ºæåš‡ã€é¨·æ“¾ã€æ¥è§¸ã€è·Ÿè¹¤ä¹‹è¡Œç‚º", "ç¦æ­¢å°‘å¹´åƒèˆ‡ä»»ä½•æ ¡å¤–æ´»å‹•", "ç¦æ­¢å°‘å¹´èˆ‡ä»»ä½•æœ‹å‹äº¤è«‡"],
    correctAnswerIndex: 1
  },
  {
    question: "è‹¥å¯†é›†è¨Šæ¯é¨·æ“¾çš„è¡Œç‚ºåš´é‡åˆ°é•åã€Šè·Ÿè¹¤é¨·æ“¾é˜²åˆ¶æ³•ã€‹æˆ–æ§‹æˆå¼·åˆ¶ç½ªï¼Œä¾ã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 3 æ¢ï¼Œæ­¤äº‹ä»¶æ‡‰ç”±å“ªå€‹æ©Ÿé—œè™•ç†ï¼Ÿ",
    options: ["å­¸æ ¡è¨“å°è™•", "å®¶é•·æœƒ", "å°‘å¹´æ³•é™¢", "ç•¶åœ°é‡Œè¾¦å…¬å®¤"],
    correctAnswerIndex: 2
  },
  {
    question: "ã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ä¸­è¦å®šï¼Œå°‘å¹´æ³•é™¢åœ¨æ­£å¼å¯©ç†äº‹ä»¶å¾Œï¼Œæ‡‰ä»¥è£å®šè«­çŸ¥å››ç¨®é¡å‹çš„ä¿è­·è™•åˆ†ã€‚ä¸‹åˆ—ä½•è€…ä¸æ˜¯é€™å››ç¨®ä¿è­·è™•åˆ†ä¹‹ä¸€ï¼Ÿ",
    options: ["äº¤ä»˜ä¿è­·ç®¡æŸ", "æ”¯ä»˜é«˜é¡ç½°é‡‘çµ¦åœ‹åº«", "è¨“èª¡ä¸¦å¾—äºˆä»¥å‡æ—¥ç”Ÿæ´»è¼”å°", "ä»¤å…¥æ„ŸåŒ–æ•™è‚²è™•æ‰€æ–½ä»¥æ„ŸåŒ–æ•™è‚²"],
    correctAnswerIndex: 1
  },
  {
    question: "ä¾æ“šç¬¬ 42 æ¢ï¼Œä¿è­·è™•åˆ†ä¸­çš„ã€äº¤ä»˜å®‰ç½®æ–¼é©ç•¶æ©Ÿæ§‹è¼”å°ã€ï¼Œç›®çš„æ˜¯ä»€éº¼ï¼Ÿ",
    options: ["æ‡²ç½°å°‘å¹´ä¸¦é™åˆ¶å…¶è‡ªç”±", "æä¾›æ›´å°ˆæ¥­çš„ç¦åˆ©ã€æ•™é¤Šæˆ–é†«ç™‚è¼”å°", "è®“å°‘å¹´é›¢é–‹å®¶åº­è‡ªè¡Œç”Ÿæ´»", "å¼·åˆ¶å°‘å¹´åƒèˆ‡å‹å‹•æœå‹™"],
    correctAnswerIndex: 1
  },
  {
    question: "è‹¥å¯†é›†è¨Šæ¯é¨·æ“¾äº‹ä»¶æƒ…ç¯€è¼•å¾®ï¼Œå°‘å¹´æ³•é™¢ä¾ç¬¬ 29 æ¢ç¬¬ 1 é …è£å®šä¸ä»˜å¯©ç†æ™‚ï¼Œä¸‹åˆ—å“ªä¸€é …æ˜¯å¯å°å°‘å¹´æ¡å–çš„è™•åˆ†ï¼Ÿ",
    options: ["å°‡å°‘å¹´å§“åå…¬é–‹æ–¼åª’é«”", "äº¤ä»˜å°‘å¹´ä¹‹æ³•å®šä»£ç†äººæˆ–ç¾åœ¨ä¿è­·å°‘å¹´ä¹‹äººåš´åŠ ç®¡æ•™", "å¼·åˆ¶å°‘å¹´è³ å„Ÿåè¬å…ƒä»¥ä¸Š", "å¼·åˆ¶è½‰ä»‹åˆ°å°‘å¹´ç›£ç„"],
    correctAnswerIndex: 1
  },
  {
    question: "åœ¨å°‘å¹´å¸æ³•ä¸­ï¼Œå°æ–¼å¯†é›†è¨Šæ¯é¨·æ“¾é€™ç¨®é€ æˆç²¾ç¥å£“åŠ›çš„è¡Œç‚ºï¼Œæ³•é™¢æœƒå„ªå…ˆè€ƒé‡ä»¥å“ªç¨®æ–¹å¼é€²è¡Œè™•é‡ï¼Ÿ",
    options: ["å¨åš‡æ‡²ç½°", "è¼”å°æ•™è‚²", "ç¶“æ¿Ÿåˆ¶è£", "çµ‚èº«éš”é›¢"],
    correctAnswerIndex: 1
  },
  {
    question: "ç•¶å°‘å¹´äº‹ä»¶è¢«è½‰ä»‹åˆ°å°‘å¹´æ³•é™¢æ™‚ï¼Œæœ€å…ˆé€²è¡Œå·¥ä½œï¼Œè² è²¬å®¢è§€äº‹å¯¦èª¿æŸ¥ã€è©•ä¼°å°‘å¹´ç‹€æ³çš„æ˜¯èª°ï¼Ÿ",
    options: ["æ³•å®˜", "å°‘å¹´èª¿æŸ¥å®˜", "æª¢å¯Ÿå®˜", "å­¸æ ¡å°å¸«"],
    correctAnswerIndex: 1
  },
  {
    question: "å¦‚æœå°‘å¹´è¢«æ³•é™¢è£å®šã€ä¿è­·ç®¡æŸã€è™•åˆ†ï¼Œä»£è¡¨ä»–å¿…é ˆå®šæœŸæ¥å—èª°çš„è¼”å°èˆ‡ç›£ç£ï¼Ÿ",
    options: ["å­¸æ ¡è€å¸«", "å°‘å¹´ä¿è­·å®˜", "ç¤¾å·¥äººå“¡", "å°‘å¹´ä¹‹æ³•å®šä»£ç†äºº"],
    correctAnswerIndex: 1
  },
  {
    question: "æ ¹æ“šç¬¬ 29 æ¢ç¬¬ 1 é …ï¼Œå°‘å¹´æ³•é™¢è‹¥è£å®šä¸ä»˜å¯©ç†ï¼Œä¸‹åˆ—å“ªä¸€é …è™•åˆ†å±¬æ–¼ç”±ç¤¾æœƒç¦åˆ©ç³»çµ±æˆ–å°ˆæ¥­æ©Ÿæ§‹åŸ·è¡Œçš„ï¼Ÿ",
    options: ["å‘Šèª¡", "è½‰ä»‹ç¦åˆ©ã€æ•™é¤Šæ©Ÿæ§‹ç­‰ç‚ºé©ç•¶ä¹‹è¼”å°", "äº¤ä»˜åš´åŠ ç®¡æ•™", "è¨“èª¡"],
    correctAnswerIndex: 1
  },
  {
    question: "ç¬¬ 26 æ¢ä¸­ï¼Œæ³•é™¢è£å®šè²¬ä»˜æ™‚ï¼Œå‘½å°‘å¹´éµå®ˆäº‹é …çš„ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ",
    options: ["æ‡²ç½°å°‘å¹´éå»çš„è¡Œç‚º", "ä¿è­·è¢«å®³äººæˆ–å…¶å®¶å±¬ï¼Œä¸¦ä¿éšœå°‘å¹´å¥å…¨è‡ªæˆ‘æˆé•·", "ç¢ºä¿å°‘å¹´ä¸æœƒç¿¹èª²", "å¼·åˆ¶å°‘å¹´å¿…é ˆæ¬å®¶"],
    correctAnswerIndex: 1
  },

  // --- å¨è„…å–è²¡ï¼ˆ10 é¡Œï¼‰ ---
  {
    question: "å°‘å¹´ä»¥å¨è„…æ–¹å¼å‘ä»–äººå–è²¡ï¼Œä¾ã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 3 æ¢ï¼Œæ­¤è¡Œç‚ºæœ€å¯èƒ½æ§‹æˆåˆ‘æ³•ä¸Šçš„å“ªä¸€é¡è¡Œç‚ºï¼Ÿ",
    options: ["å–®ç´”çš„å€Ÿè²¸è¡Œç‚º", "è§¸çŠ¯åˆ‘ç½°æ³•å¾‹ä¹‹è¡Œç‚ºï¼ˆå¦‚æåš‡å–è²¡ç½ªï¼‰", "æ ¡åœ’æƒ¡ä½œåŠ‡", "å–®ç´”æ°‘äº‹ç³¾ç´›"],
    correctAnswerIndex: 1
  },
  {
    question: "å¨è„…å–è²¡è¡Œç‚ºï¼Œå¦‚æ¶‰åŠå°è¢«å®³äººæˆ–å…¶å®¶å±¬çš„ã€è²¡ç”¢å¯¦æ–½å±å®³ã€ï¼Œå°‘å¹´æ³•é™¢ä¾ç¬¬ 26 æ¢è²¬ä»˜æ™‚ï¼Œå¯ä»¥ä¸‹é”ä½•ç¨®å¼·åˆ¶å‘½ä»¤ï¼Ÿ",
    options: ["ç¦æ­¢å°‘å¹´åœ¨æ ¡åœ’å…§æ´»å‹•", "ç¦æ­¢å°‘å¹´å°è¢«å®³äººæˆ–å…¶å®¶å±¬çš„èº«é«”æˆ–è²¡ç”¢å¯¦æ–½å±å®³", "è¦æ±‚å°‘å¹´å‘æ³•é™¢ç¹³ç´ä¿è­‰é‡‘", "é™åˆ¶å°‘å¹´åœ¨å¤œé–“çš„é–€ç¦æ™‚é–“"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´æ³•é™¢å¯©ç†å¨è„…å–è²¡äº‹ä»¶å¾Œï¼Œä¾ç¬¬ 42 æ¢æ‰€è«­çŸ¥ä¸‹åˆ—ä½•è€…ä¸å±¬æ–¼ä¿è­·è™•åˆ†çš„é¡å‹ï¼Ÿ",
    options: ["è¨“èª¡ï¼Œä¸¦å¾—äºˆä»¥å‡æ—¥ç”Ÿæ´»è¼”å°", "äº¤ä»˜æˆå¹´æ³•é™¢é€²è¡Œåˆ‘äº‹å¯©åˆ¤", "äº¤ä»˜å®‰ç½®æ–¼é©ç•¶æ©Ÿæ§‹è¼”å°", "ä»¤å…¥æ„ŸåŒ–æ•™è‚²è™•æ‰€æ–½ä»¥æ„ŸåŒ–æ•™è‚²"],
    correctAnswerIndex: 1
  },
  {
    question: "å°æ–¼æƒ…ç¯€è¼•å¾®çš„å¨è„…å–è²¡äº‹ä»¶ï¼Œå°‘å¹´æ³•é™¢ç¶“èª¿æŸ¥å®˜èª¿æŸ¥å¾Œï¼Œå¯ä¾ç¬¬ 29 æ¢ç¬¬ 1 é …è£å®šä¸ä»˜å¯©ç†ï¼Œä¸‹åˆ—å“ªä¸€é …æ˜¯æ­¤è£å®šå¯æ­é…çš„è™•åˆ†ï¼Ÿ",
    options: ["å¼·åˆ¶é€²è¡Œé«˜å¼·åº¦é«”èƒ½è¨“ç·´", "è½‰ä»‹ç¦åˆ©ã€æ•™é¤Šæ©Ÿæ§‹ç­‰ç‚ºé©ç•¶ä¹‹è¼”å°", "è¦æ±‚å°‘å¹´å…¬é–‹é“æ­‰ä¸¦ç™»å ±", "ç¦æ­¢å°‘å¹´æœªä¾†å¾äº‹ä»»ä½•å•†æ¥­æ´»å‹•"],
    correctAnswerIndex: 1
  },
  {
    question: "å½±ç‰‡ä¸­æåŠï¼Œå°‘å¹´äº‹ä»¶è™•é‡çš„ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ",
    options: ["æé«˜å°‘å¹´çš„åˆ‘è²¬", "ä»¥æ•™è‚²è¼”å°å–ä»£æ‡²ç½°ï¼Œä¿éšœå°‘å¹´å¥å…¨è‡ªæˆ‘æˆé•·", "åƒ…æ³¨é‡è¢«å®³äººçš„ç¶“æ¿Ÿè³ å„Ÿ", "å¼·åˆ¶å°‘å¹´æ”¹è®Šè·æ¥­å¿—å‘"],
    correctAnswerIndex: 1
  },
  {
    question: "å¨è„…å–è²¡äº‹ä»¶çš„å°‘å¹´å¦‚æœè¢«äº¤ä»˜ã€ä¿è­·ç®¡æŸã€ï¼Œé€šå¸¸æœƒç”±èª°ä¾†å®šæœŸçµ¦äºˆè¼”å°èˆ‡ç›£ç£ï¼Ÿ",
    options: ["å°‘å¹´æ³•é™¢é™¢é•·", "å°‘å¹´ä¿è­·å®˜", "å­¸æ ¡çš„æ•™å®˜", "è¢«å®³äººçš„å¾‹å¸«"],
    correctAnswerIndex: 1
  },
  {
    question: "æ ¹æ“šç¬¬ 29 æ¢ç¬¬ 1 é …ï¼Œä¸ä»˜å¯©ç†è™•åˆ†ä¸­çš„ã€äº¤ä»˜å°‘å¹´ä¹‹æ³•å®šä»£ç†äººæˆ–ç¾åœ¨ä¿è­·å°‘å¹´ä¹‹äººåš´åŠ ç®¡æ•™ã€ï¼Œé€™å±¬æ–¼å“ªä¸€é¡æ€§è³ªçš„è™•åˆ†ï¼Ÿ",
    options: ["äº¤ç”±å¸æ³•æ©Ÿé—œç®¡è½„", "äº¤ç”±å®¶åº­æˆ–ç›£è­·äººåŸ·è¡Œ", "äº¤ç”±å­¸æ ¡è€å¸«åŸ·è¡Œ", "äº¤ç”±è­¦å¯Ÿæ©Ÿé—œåŸ·è¡Œ"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´æ³•é™¢ä¾ç¬¬ 42 æ¢è«­çŸ¥ã€å‡æ—¥ç”Ÿæ´»è¼”å°ã€è™•åˆ†ï¼Œé€šå¸¸æœƒæ­é…ä¸‹åˆ—å“ªä¸€é …è™•åˆ†ï¼Ÿ",
    options: ["äº¤ä»˜ä¿è­·ç®¡æŸ", "æ„ŸåŒ–æ•™è‚²", "è¨“èª¡", "è½‰ä»‹é†«ç™‚æ©Ÿæ§‹"],
    correctAnswerIndex: 2
  },
  {
    question: "å°‘å¹´æ³•é™¢è™•ç†å°‘å¹´äº‹ä»¶æ™‚ï¼Œå¾äº‹ä»¶ç™¼ç”Ÿåˆ°è£å®šè™•åˆ†ï¼Œç¬¬ä¸€å€‹éšæ®µçš„å·¥ä½œæ˜¯ï¼Ÿ",
    options: ["ç«‹å³åˆ¤æ±º", "å°‘å¹´èª¿æŸ¥å®˜é€²è¡Œèª¿æŸ¥å’Œè©•ä¼°", "ç›´æ¥å¯¦æ–½æ„ŸåŒ–æ•™è‚²", "å°‡æ¡ˆä»¶è½‰äº¤æª¢å¯Ÿç½²"],
    correctAnswerIndex: 1
  },
  {
    question: "åœ¨å°‘å¹´äº‹ä»¶ä¸­ï¼Œã€æ„ŸåŒ–æ•™è‚²ã€é€šå¸¸è¢«è¦–ç‚ºå°å°‘å¹´æ‰€ä½œå‡ºçš„å“ªä¸€ç¨®æ€§è³ªçš„è™•åˆ†ï¼Ÿ",
    options: ["æœ€è¼•å¾®çš„å‘Šèª¡", "æœ€åš´å²çš„æ•™è‚²è¼”å°æ‰‹æ®µ", "è‡¨æ™‚æ€§çš„å®‰ç½®æªæ–½", "å®¶åº­è¦ªè·æ•™è‚²çš„æ›¿ä»£æ–¹æ¡ˆ"],
    correctAnswerIndex: 1
  },

  // --- ç¶²è·¯æ•£å¸ƒè¬ è¨€ï¼ˆ10 é¡Œï¼‰ ---
  {
    question: "å°‘å¹´åœ¨ç¶²è·¯ä¸Šæ•£å¸ƒè¬ è¨€é€ æˆä»–äººåè­½å—æï¼Œä¾ã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 3 æ¢ï¼Œè©²è¡Œç‚ºæœ€å¯èƒ½è¢«æ­¸é¡ç‚ºä¸‹åˆ—å“ªä¸€é …ï¼Ÿ",
    options: ["å–®ç´”è¨€è«–è‡ªç”±çš„ç¯„ç–‡", "è§¸çŠ¯åˆ‘ç½°æ³•å¾‹ä¹‹è¡Œç‚º", "ç¶²è·¯æ–‡åŒ–ï¼Œä¸å…·æ³•å¾‹æ•ˆåŠ›", "åƒ…ç”±ç¶²è·¯å¹³å°æ¥­è€…è™•ç†çš„æ°‘äº‹ç³¾ç´›"],
    correctAnswerIndex: 1
  },
  {
    question: "ä¾æ“šã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 83 æ¢ï¼Œåª’é«”ã€è³‡è¨Šæˆ–å…¬ç¤ºæ–¹å¼ä¸å¾—æ­ç¤ºå“ªé¡è³‡è¨Šï¼Œä»¥ä¿è­·æ¶‰æ¡ˆå°‘å¹´ï¼Ÿ",
    options: ["å°‘å¹´æ³•é™¢çš„åœ°å€", "è¶³ä»¥çŸ¥æ‚‰å…¶äººç‚ºè©²ä¿è­·äº‹ä»¶å—èª¿æŸ¥ä¹‹å°‘å¹´çš„è¨˜äº‹æˆ–ç…§ç‰‡", "æ³•é™¢è£å®šçš„çµæœ", "å°‘å¹´æ¡ˆä»¶çš„å¯©ç†æ—¥æœŸ"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´æ³•é™¢å¯©ç†ç¶²è·¯æ•£å¸ƒè¬ è¨€äº‹ä»¶å¾Œï¼Œä¾ç¬¬ 42 æ¢è«­çŸ¥ä¿è­·è™•åˆ†æ™‚ï¼Œä¸‹åˆ—å“ªä¸€é …ä¸å±¬æ–¼ä¿è­·è™•åˆ†çš„é¡å‹ï¼Ÿ",
    options: ["äº¤ä»˜å®‰ç½®è¼”å°", "é™åˆ¶å°‘å¹´çµ‚èº«ä¸å¾—ä½¿ç”¨ç¶²è·¯", "äº¤ä»˜ä¿è­·ç®¡æŸ", "ä»¤å…¥æ„ŸåŒ–æ•™è‚²è™•æ‰€æ–½ä»¥æ„ŸåŒ–æ•™è‚²"],
    correctAnswerIndex: 1
  },
  {
    question: "åœ¨å°‘å¹´æ•£å¸ƒè¬ è¨€äº‹ä»¶ä¸­ï¼Œå¦‚æœæƒ…ç¯€è¼•å¾®ï¼Œæ³•é™¢ä¾ç¬¬ 29 æ¢ç¬¬ 1 é …è£å®šä¸ä»˜å¯©ç†ï¼Œå¯ä»¥åŒæ™‚ç‚ºä¸‹åˆ—å“ªç¨®è™•åˆ†ï¼Ÿ",
    options: ["å¼·åˆ¶é€²è¡Œå¿ƒç†æ²»ç™‚", "å‘Šèª¡", "ç«‹å³ç½°æ¬¾æ–°è‡ºå¹£äº”è¬å…ƒ", "å…¬é–‹å°‘å¹´å§“åè­¦ç¤º"],
    correctAnswerIndex: 1
  },
  {
    question: "ç¶²è·¯æ•£å¸ƒè¬ è¨€å°è¢«å®³äººåè­½é€ æˆæå®³ï¼Œæ³•é™¢ä¾ç¬¬ 29 æ¢ç¬¬ 3 é …ä¿ƒæˆä¿®å¾©æ™‚ï¼Œä¸‹åˆ—å“ªä¸€é …æ˜¯å°‘å¹´å¯èƒ½è¢«å‘½è² èµ·çš„è²¬ä»»ï¼Ÿ",
    options: ["å…è²»å¹«è¢«å®³äººå·¥ä½œä¸€å¹´", "å°è¢«å®³äººä¹‹æå®³è² è³ å„Ÿè²¬ä»»", "æ’°å¯«ä¸€ç¯‡å­¸è¡“è«–æ–‡", "æ°¸ä¹…é—œé–‰æ‰€æœ‰ç¤¾ç¾¤åª’é«”å¸³è™Ÿ"],
    correctAnswerIndex: 1
  },
  {
    question: "å½±ç‰‡ä¸­æåˆ°ï¼Œè™•ç†å°‘å¹´äº‹ä»¶æ™‚ï¼Œæ‡‰å„ªå…ˆè€ƒé‡å“ªå€‹æ ¸å¿ƒåŸå‰‡ï¼Ÿ",
    options: ["ä»¥æ‡²ç½°å°‘å¹´ç‚ºå”¯ä¸€ç›®çš„", "ä¿éšœå°‘å¹´å¥å…¨è‡ªæˆ‘æˆé•·ï¼ŒåŒæ™‚å…¼é¡§å…¬å…±åˆ©ç›Š", "åƒ…æ³¨é‡è¢«å®³äººçš„ç¶“æ¿Ÿè³ å„Ÿ", "å¼·åˆ¶è¦æ±‚å°‘å¹´æ”¹è®Šè·æ¥­å¿—å‘"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´åœ¨ç¶²è·¯ä¸Šçš„ä¸ç•¶è¡Œç‚ºè¢«èªå®šç‚ºè§¸çŠ¯åˆ‘ç½°æ³•å¾‹è¡Œç‚ºå¾Œï¼Œæœƒç”±å“ªå€‹å–®ä½ä¾†é€²è¡Œèª¿æŸ¥ï¼Ÿ",
    options: ["ç¶²è·¯è­¦å¯Ÿå±€çš„ç¶²å®‰å¤§éšŠ", "å­¸æ ¡çš„è¨“å°è™•", "å°‘å¹´æ³•é™¢çš„å°‘å¹´èª¿æŸ¥å®˜", "å°‘å¹´è¼”å°å§”å“¡æœƒ"],
    correctAnswerIndex: 2
  },
  {
    question: "ä¾æ“šç¬¬ 29 æ¢ç¬¬ 3 é …çš„è¦å®šï¼Œå°‘å¹´æ³•é™¢åœ¨ä¸ä»˜å¯©ç†å‰è½‰ä»‹é€²è¡Œä¿®å¾©ï¼Œå¿…é ˆç²å¾—å“ªä¸‰æ–¹çš„åŒæ„ï¼Ÿ",
    options: ["å°‘å¹´ã€æª¢å¯Ÿå®˜ã€æ³•å®˜", "å°‘å¹´ã€çˆ¶æ¯ï¼ˆæ³•å®šä»£ç†äººï¼‰ã€è€å¸«", "å°‘å¹´ã€å°‘å¹´ä¹‹æ³•å®šä»£ç†äººã€è¢«å®³äºº", "å°‘å¹´ã€ç¶²è·¯å¹³è‡ºç®¡ç†è€…ã€å­¸æ ¡"],
    correctAnswerIndex: 2
  },
  {
    question: "å°‘å¹´æ³•é™¢çš„ã€ä¿è­·ç®¡æŸã€è™•åˆ†ï¼Œé€šå¸¸æœƒæ­é…ä¸‹åˆ—å“ªä¸€ç¨®è¼”å°æªæ–½ï¼Ÿ",
    options: ["æ¯æ—¥å¼·åˆ¶æ‰“æƒç’°å¢ƒ", "ç”±ä¿è­·å®˜å®šæœŸé€²è¡Œè¼”å°æ™¤è«‡èˆ‡è¿½è¹¤", "é™åˆ¶å°‘å¹´å‡ºåœ‹æ—…éŠ", "å¼·åˆ¶è¦æ±‚å°‘å¹´å¾äº‹é«˜é¢¨éšªå·¥ä½œ"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´æ³•é™¢åœ¨è™•ç†ç¶²è·¯æ•£å¸ƒè¬ è¨€äº‹ä»¶æ™‚ï¼Œå¦‚æœæ±ºå®šä¸ä»˜å¯©ç†ï¼Œä¸‹åˆ—å“ªä¸€å€‹è™•åˆ†æ˜¯äº¤ç”±å°‘å¹´å®¶é•·åŸ·è¡Œçš„ï¼Ÿ",
    options: ["ä»¤å…¥æ„ŸåŒ–æ•™è‚²", "è½‰ä»‹é†«ç™‚æ©Ÿæ§‹è¼”å°", "äº¤ä»˜å°‘å¹´ä¹‹æ³•å®šä»£ç†äººæˆ–ç¾åœ¨ä¿è­·å°‘å¹´ä¹‹äººåš´åŠ ç®¡æ•™", "å‹å‹•æœå‹™"],
    correctAnswerIndex: 2
  },

  // --- è‚¢é«”æ¨æ‰“ï¼ˆ10 é¡Œï¼‰ ---
  {
    question: "æ ¹æ“šã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 3 æ¢ï¼Œå°‘å¹´è‚¢é«”æ¨æ‰“ä»–äººé€šå¸¸è¢«æ­¸é¡æ–¼ä¸‹åˆ—å“ªä¸€ç¨®è¡Œç‚ºï¼Ÿ",
    options: ["ç„¡é ˆè™•ç†çš„å–®ç´”æ ¡åœ’è¡çª", "è§¸çŠ¯åˆ‘ç½°æ³•å¾‹ä¹‹è¡Œç‚º", "å–®ç´”çš„æƒ…ç·’è¡¨é”è¡Œç‚º", "ç”±å­¸æ ¡è‡ªè¡Œè™•ç†çš„è¡Œæ”¿äº‹ä»¶"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´æ³•é™¢ä¾ã€Šå°‘å¹´äº‹ä»¶è™•ç†æ³•ã€‹ç¬¬ 42 æ¢è«­çŸ¥ä¿è­·è™•åˆ†æ™‚ï¼Œä¸åŒ…æ‹¬ä¸‹åˆ—å“ªä¸€é …é¡å‹ï¼Ÿ",
    options: ["äº¤ä»˜æˆå¹´ç›£ç„æ–½ä»¥æ‡²ç½°", "è¨“èª¡ï¼Œä¸¦å¾—äºˆä»¥å‡æ—¥ç”Ÿæ´»è¼”å°", "äº¤ä»˜ä¿è­·ç®¡æŸä¸¦å¾—å‘½ç‚ºå‹å‹•æœå‹™", "ä»¤å…¥æ„ŸåŒ–æ•™è‚²è™•æ‰€æ–½ä»¥æ„ŸåŒ–æ•™è‚²"],
    correctAnswerIndex: 0
  },
  {
    question: "å°‘å¹´æ³•é™¢åœ¨è£å®šè²¬ä»˜å°‘å¹´æ™‚ï¼Œå¦‚æœäº‹ä»¶æ¶‰åŠè‚¢é«”æ¨æ‰“æˆ–é€ æˆè¼•å‚·ï¼Œæ³•é™¢ä¾ç¬¬ 26 æ¢å¯å‘½å°‘å¹´éµå®ˆçš„äº‹é …æ˜¯ï¼Ÿ",
    options: ["ç¦æ­¢å°è¢«å®³äººæˆ–å…¶å®¶å±¬å¯¦æ–½å±å®³ã€æåš‡ã€é¨·æ“¾ç­‰è¡Œç‚º","ç¦æ­¢å°‘å¹´ä½¿ç”¨æ‰‹æ©ŸåŠé›»è…¦",  "å¼·åˆ¶è½‰å­¸æˆ–ä¼‘å­¸", "å¼·åˆ¶å°‘å¹´è³ å„Ÿæ‰€æœ‰è²¡ç”¢æå¤±"],
    correctAnswerIndex: 0
  },
  {
    question: "æ ¹æ“šç¬¬ 29 æ¢ç¬¬ 3 é …ï¼Œå°‘å¹´æ³•é™¢åœ¨ä¸ä»˜å¯©ç†è£å®šå‰ï¼Œç¶“ç•¶äº‹äººä¸‰æ–¹åŒæ„ï¼Œå¯è½‰ä»‹é€²è¡Œä¿®å¾©ï¼Œè«‹å•ä¸‹åˆ—å“ªä¸€é …ä¸æ˜¯å°‘å¹´éœ€å°è¢«å®³äººåšå‡ºçš„äº‹é …ï¼Ÿ",
    options: ["å°è¢«å®³äººä¹‹æå®³è² è³ å„Ÿè²¬ä»»", "ç«‹æ‚”éæ›¸", "å‘è¢«å®³äººé“æ­‰", "çµ‚èº«é¿å…æ¥è§¸è¢«å®³äºº"],
    correctAnswerIndex: 3
  },
  {
    question: "å°æ–¼è‚¢é«”æ¨æ‰“é€™é¡æƒ…ç¯€è¼•å¾®çš„å°‘å¹´äº‹ä»¶ï¼Œå°‘å¹´æ³•é™¢ç¶“èª¿æŸ¥å¾Œèªç‚ºé©ç•¶ï¼Œå¯ä¾ç¬¬ 29 æ¢ç¬¬ 1 é …è£å®šä¸ä»˜å¯©ç†ï¼Œä¸¦ç‚ºä¸‹åˆ—ä½•ç¨®è™•åˆ†ï¼Ÿ",
    options: ["å¼·åˆ¶é€å…¥æ„ŸåŒ–æ•™è‚²", "å‘Šèª¡", "ç«‹å³äº¤ä»˜ä¿è­·ç®¡æŸ", "å¼·åˆ¶è½‰ä»‹é†«ç™‚æ©Ÿæ§‹"],
    correctAnswerIndex: 1
  },
  {
    question: "è‹¥å°‘å¹´å› è‚¢é«”è¡çªè‡´äººè¼•å‚·ï¼Œæ ¹æ“šå°‘å¹´å¸æ³•åŸå‰‡ï¼Œæ³•é™¢æœƒå„ªå…ˆè€ƒæ…®ä¸‹åˆ—å“ªä¸€é …è™•é‡ç›®æ¨™ï¼Ÿ",
    options: ["ä»¥æœ€åš´å²çš„åˆ‘ç½°é€²è¡Œè™•ç½°", "åªè€ƒæ…®è¢«å®³äººçš„æ„Ÿå—å’Œæ¬Šç›Š", "è¦æ±‚å°‘å¹´ç«‹å³æœå…µå½¹ä½œç‚ºæ‡²ç½°", "ä»¥ä¿éšœå°‘å¹´å¥å…¨è‡ªæˆ‘æˆé•·ç‚ºä¸­å¿ƒï¼ŒåŒæ™‚å…¼é¡§å…¬å…±åˆ©ç›Š"],
    correctAnswerIndex: 3
  },
  {
    question: "å°‘å¹´äº‹ä»¶è™•ç†æ³•ä¸­çš„ã€ä¿è­·è™•åˆ†ã€ï¼Œèˆ‡åˆ‘æ³•ä¸­çš„ã€åˆ‘ç½°ã€æœ€ä¸»è¦çš„å€åˆ¥æ˜¯ä»€éº¼ï¼Ÿ",
    options: ["ä¿è­·è™•åˆ†æ›´æ³¨é‡ç¶“æ¿Ÿæ‡²ç½°", "ä¿è­·è™•åˆ†æ›´æ³¨é‡è¼”å°å’Œæ•™è‚²ï¼Œä»¥å–ä»£å¨åš‡æ€§æ‡²ç½°", "ä¿è­·è™•åˆ†åƒ…é™æ–¼å‡æ—¥åŸ·è¡Œ", "ä¿è­·è™•åˆ†ç”±è­¦å¯Ÿè€Œéæ³•é™¢æ±ºå®š"],
    correctAnswerIndex: 1
  },
  {
    question: "å°‘å¹´äº‹ä»¶èª¿æŸ¥å®˜åœ¨è‚¢é«”æ¨æ‰“äº‹ä»¶ä¸­çš„ä¸»è¦è·è²¬æ˜¯ï¼Ÿ",
    options: ["ç›´æ¥åˆ¤æ±ºå°‘å¹´æœ‰ç½ªæˆ–ç„¡ç½ª", "é€²è¡Œå®¢è§€äº‹å¯¦èª¿æŸ¥ã€è©•ä¼°å°‘å¹´ç‹€æ³ï¼Œä¸¦å»ºè­°æ³•é™¢è™•é‡æ–¹å¼", "åƒ…è² è²¬å°å°‘å¹´é€²è¡Œè¨“èª¡", "è² è²¬å‘è¢«å®³äººæä¾›æ³•å¾‹è«®è©¢æœå‹™"],
    correctAnswerIndex: 1
  },
  {
    question: "æ ¹æ“šå°‘å¹´æ³•é™¢å¯©ç†çš„æµç¨‹ï¼Œç¬¬ 42 æ¢çš„ä¿è­·è™•åˆ†æ˜¯ä¸‹åˆ—å“ªä¸€å€‹æ­¥é©Ÿçš„çµæœï¼Ÿ",
    options: ["å°‘å¹´äº‹ä»¶èª¿æŸ¥å®˜èª¿æŸ¥å‰çš„è™•ç½®", "å°‘å¹´æ³•é™¢å¯©ç†äº‹ä»¶å¾Œå°å°‘å¹´åšå‡ºçš„è£å®š", "å°‘å¹´åœ¨å­¸æ ¡è¢«è¨˜éå¾Œçš„æ‡²ç½°", "è­¦å¯Ÿæ©Ÿé—œå°‡æ¡ˆä»¶ç§»é€æ³•é™¢çš„æ­¥é©Ÿ"],
    correctAnswerIndex: 1
  },
  {
    question: "åœ¨å°‘å¹´äº‹ä»¶çš„ä¿®å¾©ç¨‹åºä¸­ï¼ˆç¬¬ 29 æ¢ç¬¬ 3 é …ï¼‰ï¼Œè‹¥è¦é€²è¡Œå’Œè§£æˆ–è³ å„Ÿï¼Œå¿…é ˆç²å¾—å“ªä¸‰æ–¹çš„åŒæ„ï¼Ÿ",
    options: ["å°‘å¹´ã€è­¦å¯Ÿã€è€å¸«", "å°‘å¹´ã€å°‘å¹´ä¹‹æ³•å®šä»£ç†äººã€è¢«å®³äºº", "æ³•å®˜ã€æª¢å¯Ÿå®˜ã€å¾‹å¸«", "å°‘å¹´ã€è¼”å°è€å¸«ã€å­¸æ ¡æ ¡é•·"],
    correctAnswerIndex: 1
  }
];

// ======================================
//       ä¾è¡Œç‚ºé¡å‹éæ¿¾é¡Œç›®
// ======================================

const filtered = allQuestions.filter(q => selectedTypes.includes(q.questionType));

if (filtered.length === 0) {
    alert("ç›®å‰æ²’æœ‰å°æ‡‰æ‚¨å‹¾é¸è¡Œç‚ºçš„å­¸ç¿’é¡Œç›®ï¼");
    window.location.href = "query.html";
}

// ======================================
//         å¹³å‡æŠ½é¡Œï¼šåˆè¨ˆ 10 é¡Œ
// ======================================

function drawQuestionsEvenly() {
    let result = [];
    let perType = Math.ceil(10 / selectedTypes.length); // æ¯é¡å¹³å‡æŠ½é¡Œ

    for (let type of selectedTypes) {
        let pool = filtered.filter(q => q.questionType === type);
        pool = shuffle(pool);
        result = result.concat(pool.slice(0, perType));

        if (result.length >= 10) break;
    }

    result = shuffle(result).slice(0, 10); // æœ€çµ‚ä¿ç•™ 10 é¡Œ
    return result;
}

// Fisherâ€“Yates shuffle
function shuffle(array) {
    let a = array.slice();
    for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
}

const quizQuestions = drawQuestionsEvenly();

// ======================================
//          é¡¯ç¤ºé¡Œç›®ï¼ˆ10 é¡Œï¼‰
// ======================================

const quizContainer = document.getElementById("quiz-container");

function renderQuiz() {
    let html = "";

    quizQuestions.forEach((q, idx) => {
        html += `
            <div class="quiz-question">
                <h3>${idx + 1}. ${q.question}</h3>
                ${q.options.map((op, i) => `
                    <label class="option">
                        <input type="radio" name="q${idx}" value="${i}">
                        ${op}
                    </label>
                `).join("")}
            </div>
        `;
    });

    quizContainer.innerHTML = html;
}

renderQuiz();

// ======================================
//         é€å‡ºã€ç®—åˆ†æ•¸
// ======================================

document.getElementById("submit-btn").addEventListener("click", function () {

    let score = 0;

    quizQuestions.forEach((q, idx) => {
        let selected = document.querySelector(`input[name="q${idx}"]:checked`);
        if (selected && parseInt(selected.value) === q.correctAnswerIndex) {
            score += 10; // æ¯é¡Œ 10 åˆ†ï¼ˆ10 é¡Œå…± 100 åˆ†ï¼‰
        }
    });

    localStorage.setItem("quiz_score", score);

    if (score >= 60) {
        alert(`æ­å–œï¼æ‚¨å¾—åˆ† ${score} åˆ†ï¼Œå·²é”åŠæ ¼æ¨™æº–ï¼`);
        window.location.href = "reflection.html";
    } else {
        alert(`æ‚¨å¾—åˆ† ${score} åˆ†ï¼Œæœªé” 60 åˆ†ï¼Œè«‹é‡æ–°ä½œç­”ã€‚`);
        window.location.reload();
    }
});
